<script>

(function(){

    const gameScores = { "playerScore": 0, "computerScore": 0 };
        
    const gameRoundsCount =  { rounds: 0 };

    function upperCaseFirst(strValue) {

        let arrayString = strValue.split("");

        return arrayString[0].toUpperCase() + arrayString.slice(1, arrayString.length).join(""); 

    }

    function getGamesPlayable() {

        return ['rock', 'scissors', 'paper'];
        
    }

    function computerPlay() {

        const randomNumber = Math.floor((Math.random() * 10) / 4);

        return getGamesPlayable()[ randomNumber ];
    }

    function playRound(playerSelection, computerSelection) {

        playerSelection = playerSelection.toLowerCase();

        let result = Array(2);

        //if( getGamesPlayable().indexOf( playerSelection ) === -1 )
        //console.log("User input is wrong"); return;

        if( (playerSelection === "rock") && (computerSelection === "scissors")
            || ((playerSelection === "scissors") && (computerSelection === "paper"))
            || ((playerSelection === "paper") && (computerSelection === "rock"))){ 

            result[0] = `You Win! ${ upperCaseFirst( playerSelection ) } beats ${ upperCaseFirst( computerSelection ) }`;
            result[1] = 'win';

        } else if( playerSelection === computerSelection){ 

            result[0] = `You Draw!`;
            result[1] = 'draw';

        } else {

            result[0] = `You Lose! ${ upperCaseFirst( computerSelection ) } beats ${ upperCaseFirst( playerSelection ) }`;
            result[1] = 'lose';

        }

        return result;

    }

    function addScore( gamePlayer ) {

        switch( gamePlayer ){
            case "player":
                gameScores.playerScore += 1;
                break;
            
            case "computer":
                gameScores.computerScore += 1;
                break;
        }

    }

    function incrementGameRoundsCount() {

        gameRoundsCount.rounds += 1;

    }

    function displayResult( result, showAlert = false) {

        console.log( result );
                
        if( showAlert )
        alert( result );

    }

    function game() {

        let playerSelection = prompt("Play one of the following: Rock, Paper or Scissors");

        let computerSelection = computerPlay();

        const result = playRound(playerSelection, computerSelection);

        displayResult( result[0], true );

        if( result[1] === "win" ){ 
            
            addScore("player"); 
            
        } else if( result[1] === "lose" ){ 
        
            addScore("computer"); 

        }

        incrementGameRoundsCount();

        if( gameRoundsCount.rounds === 5 ) {

            const { computerScore, playerScore } = gameScores;

            let finalResult;
                
            if( computerScore > playerScore ){
                
                finalResult = `Computer wins! ${computerScore} : ${playerScore} `;

            } else {

                finalResult = `You win! ${playerScore} : ${computerScore} `;

            }

            displayResult( finalResult, true );

            return;
        }

        game();
    }

    game();

})();
</script>